{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TenderResult(){const[data,setData]=useState(null);const[loading,setLoading]=useState(false);useEffect(()=>{const stored=localStorage.getItem(\"tender_result\");if(stored)setData(JSON.parse(stored));},[]);const requestRecommendation=async()=>{if(!data||!data.chosen||!data.chosen.product)return alert(\"No chosen product\");try{setLoading(true);const res=await axios.post(\"/recommend_bid\",{product_name:data.chosen.product.name,quantity:data.quantity_litres,baseline_total:data.chosen.pricing.total_cost});localStorage.setItem(\"latest_recommendation\",JSON.stringify(res.data.recommendation));window.location.href=\"/bidding\";}catch(err){console.error(\"Recommendation error\",err);alert(\"Failed to fetch recommendations\");}finally{setLoading(false);}};const downloadQuickProposal=async()=>{if(!data)return alert(\"No data\");try{const res=await axios.post(\"/generate_proposal_pdf\",data,{responseType:\"blob\"});const url=window.URL.createObjectURL(new Blob([res.data]));const a=document.createElement(\"a\");a.href=url;a.download=\"proposal_\".concat(Date.now(),\".pdf\");a.click();}catch(e){console.error(\"PDF error\",e);alert(\"Could not generate proposal PDF\");}};if(!data)return/*#__PURE__*/_jsx(\"div\",{style:{padding:12},children:\"No tender processed yet. Go to Home and upload PDF.\"});const chosen=data.chosen;const top=data.top_matches||[];return/*#__PURE__*/_jsxs(\"div\",{style:{padding:12},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Tender Result\"}),/*#__PURE__*/_jsxs(\"section\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Extracted (first 1000 chars)\"}),/*#__PURE__*/_jsx(\"pre\",{style:{background:\"#f7f7f7\",padding:12,maxHeight:160,overflow:\"auto\"},children:data.extracted_text})]}),/*#__PURE__*/_jsxs(\"section\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Top Matches\"}),top.length===0&&/*#__PURE__*/_jsx(\"div\",{children:\"No matches \\u2014 upload product CSV first.\"}),top.map((m,i)=>{var _m$pricing,_m$gaps;return/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid #eee\",padding:10,marginBottom:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700},children:m.product.name||m.product.Name}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Score: \",m.score]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Pricing total: \",(_m$pricing=m.pricing)===null||_m$pricing===void 0?void 0:_m$pricing.total_cost]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Gaps: \",(_m$gaps=m.gaps)!==null&&_m$gaps!==void 0&&_m$gaps.length?m.gaps.join(\"; \"):\"None\"]})]},i);})]}),/*#__PURE__*/_jsxs(\"section\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Chosen / Best Match\"}),chosen?/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid #ddd\",padding:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700},children:chosen.product.name}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Match score: \",chosen.score]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Quantity: \",data.quantity_litres]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Pricing total: \",chosen.pricing.total_cost]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsx(\"button\",{onClick:downloadQuickProposal,style:{marginRight:8},children:\"Download Quick Proposal\"}),/*#__PURE__*/_jsx(\"button\",{onClick:requestRecommendation,disabled:loading,children:loading?\"Loading...\":\"View Bid Recommendations\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href=\"/company\",style:{marginLeft:8},children:\"Enter Company & Generate Final PDF\"})]})]}):/*#__PURE__*/_jsx(\"div\",{children:\"No chosen product\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","TenderResult","data","setData","loading","setLoading","stored","localStorage","getItem","JSON","parse","requestRecommendation","chosen","product","alert","res","post","product_name","name","quantity","quantity_litres","baseline_total","pricing","total_cost","setItem","stringify","recommendation","window","location","href","err","console","error","downloadQuickProposal","responseType","url","URL","createObjectURL","Blob","a","document","createElement","download","concat","Date","now","click","e","style","padding","children","top","top_matches","marginBottom","background","maxHeight","overflow","extracted_text","length","map","m","i","_m$pricing","_m$gaps","border","fontWeight","Name","score","gaps","join","marginTop","onClick","marginRight","disabled","marginLeft"],"sources":["/workspaces/tenderBidding/src/pages/TenderResult.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nexport default function TenderResult() {\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    const stored = localStorage.getItem(\"tender_result\");\n    if (stored) setData(JSON.parse(stored));\n  }, []);\n\n  const requestRecommendation = async () => {\n    if (!data || !data.chosen || !data.chosen.product) return alert(\"No chosen product\");\n    try {\n      setLoading(true);\n      const res = await axios.post(\"/recommend_bid\", {\n        product_name: data.chosen.product.name,\n        quantity: data.quantity_litres,\n        baseline_total: data.chosen.pricing.total_cost,\n      });\n      localStorage.setItem(\"latest_recommendation\", JSON.stringify(res.data.recommendation));\n      window.location.href = \"/bidding\";\n    } catch (err) {\n      console.error(\"Recommendation error\", err);\n      alert(\"Failed to fetch recommendations\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadQuickProposal = async () => {\n    if (!data) return alert(\"No data\");\n    try {\n      const res = await axios.post(\"/generate_proposal_pdf\", data, { responseType: \"blob\" });\n      const url = window.URL.createObjectURL(new Blob([res.data]));\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `proposal_${Date.now()}.pdf`;\n      a.click();\n    } catch (e) {\n      console.error(\"PDF error\", e);\n      alert(\"Could not generate proposal PDF\");\n    }\n  };\n\n  if (!data) return <div style={{ padding: 12 }}>No tender processed yet. Go to Home and upload PDF.</div>;\n\n  const chosen = data.chosen;\n  const top = data.top_matches || [];\n\n  return (\n    <div style={{ padding: 12 }}>\n      <h2>Tender Result</h2>\n\n      <section style={{ marginBottom: 12 }}>\n        <h4>Extracted (first 1000 chars)</h4>\n        <pre style={{ background: \"#f7f7f7\", padding: 12, maxHeight: 160, overflow: \"auto\" }}>{data.extracted_text}</pre>\n      </section>\n\n      <section style={{ marginBottom: 12 }}>\n        <h4>Top Matches</h4>\n        {top.length === 0 && <div>No matches â€” upload product CSV first.</div>}\n        {top.map((m, i) => (\n          <div key={i} style={{ border: \"1px solid #eee\", padding: 10, marginBottom: 8 }}>\n            <div style={{ fontWeight: 700 }}>{m.product.name || m.product.Name}</div>\n            <div>Score: {m.score}</div>\n            <div>Pricing total: {m.pricing?.total_cost}</div>\n            <div>Gaps: {m.gaps?.length ? m.gaps.join(\"; \") : \"None\"}</div>\n          </div>\n        ))}\n      </section>\n\n      <section style={{ marginBottom: 12 }}>\n        <h4>Chosen / Best Match</h4>\n        {chosen ? (\n          <div style={{ border: \"1px solid #ddd\", padding: 12 }}>\n            <div style={{ fontWeight: 700 }}>{chosen.product.name}</div>\n            <div>Match score: {chosen.score}</div>\n            <div>Quantity: {data.quantity_litres}</div>\n            <div>Pricing total: {chosen.pricing.total_cost}</div>\n            <div style={{ marginTop: 12 }}>\n              <button onClick={downloadQuickProposal} style={{ marginRight: 8 }}>Download Quick Proposal</button>\n              <button onClick={requestRecommendation} disabled={loading}>{loading ? \"Loading...\" : \"View Bid Recommendations\"}</button>\n              <button onClick={() => window.location.href=\"/company\"} style={{ marginLeft: 8 }}>Enter Company & Generate Final PDF</button>\n            </div>\n          </div>\n        ) : <div>No chosen product</div>}\n      </section>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}