{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Bidding(){const[rec,setRec]=useState(null);const[tender,setTender]=useState(null);const[minProfit,setMinProfit]=useState(3);// default 3%\nconst[selected,setSelected]=useState(null);useEffect(()=>{const r=localStorage.getItem(\"latest_recommendation\");const t=localStorage.getItem(\"tender_result\");if(r)setRec(JSON.parse(r));if(t)setTender(JSON.parse(t));},[]);useEffect(()=>{if(rec&&rec.suggestions){// choose best that meets minProfit\nconst candidates=rec.suggestions.filter(s=>(s.profit_margin_pct||0)>=Number(minProfit));const pool=candidates.length?candidates:rec.suggestions;const best=pool.reduce((a,b)=>a.expected_win_prob>b.expected_win_prob?a:b,pool[0]);setSelected(best);}},[rec,minProfit]);if(!rec)return/*#__PURE__*/_jsx(\"div\",{style:{padding:12},children:\"No recommendations available. From Tender Result click \\\"View Bid Recommendations\\\".\"});return/*#__PURE__*/_jsxs(\"div\",{style:{padding:12},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Bid Recommendations\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Minimum acceptable profit % (threshold): \"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:minProfit,onChange:e=>setMinProfit(Number(e.target.value)),style:{width:80,marginLeft:8}}),\" %\",/*#__PURE__*/_jsx(\"div\",{style:{color:\"#666\",fontSize:12,marginTop:6},children:\"System will choose highest win-prob among suggestions that meet this profit threshold. If none meet it, best overall suggestion is selected.\"})]}),/*#__PURE__*/_jsxs(\"table\",{style:{width:\"100%\",borderCollapse:\"collapse\"},children:[/*#__PURE__*/_jsx(\"thead\",{style:{background:\"#f7f7f7\"},children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid #ddd\",padding:8},children:\"Discount %\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid #ddd\",padding:8},children:\"Per Litre\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid #ddd\",padding:8},children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid #ddd\",padding:8},children:\"Profit %\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid #ddd\",padding:8},children:\"Win Prob\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rec.suggestions.map((s,idx)=>/*#__PURE__*/_jsxs(\"tr\",{style:{background:selected===s?\"#e7f7e7\":\"white\"},children:[/*#__PURE__*/_jsxs(\"td\",{style:{border:\"1px solid #ddd\",padding:8},children:[s.discount_pct,\"%\"]}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid #ddd\",padding:8},children:s.per_litre}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid #ddd\",padding:8},children:s.total}),/*#__PURE__*/_jsxs(\"td\",{style:{border:\"1px solid #ddd\",padding:8},children:[s.profit_margin_pct,\"%\"]}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid #ddd\",padding:8},children:s.expected_win_prob})]},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Selected (based on threshold):\"}),selected?/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Discount: \",selected.discount_pct,\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Per Litre: \",selected.per_litre]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Total: \",selected.total]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Expected win probability: \",selected.expected_win_prob]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// store chosen suggestion so company page knows\nlocalStorage.setItem(\"chosen_suggestion\",JSON.stringify(selected));window.location.href=\"/company\";},children:\"Proceed to Company Details & Generate Final PDF\"})})]}):/*#__PURE__*/_jsx(\"div\",{children:\"No suggestion selected\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Bidding","rec","setRec","tender","setTender","minProfit","setMinProfit","selected","setSelected","r","localStorage","getItem","t","JSON","parse","suggestions","candidates","filter","s","profit_margin_pct","Number","pool","length","best","reduce","a","b","expected_win_prob","style","padding","children","marginBottom","type","value","onChange","e","target","width","marginLeft","color","fontSize","marginTop","borderCollapse","background","border","map","idx","discount_pct","per_litre","total","onClick","setItem","stringify","window","location","href"],"sources":["/workspaces/tenderBidding/src/pages/Bidding.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nexport default function Bidding() {\n  const [rec, setRec] = useState(null);\n  const [tender, setTender] = useState(null);\n  const [minProfit, setMinProfit] = useState(3); // default 3%\n  const [selected, setSelected] = useState(null);\n\n  useEffect(() => {\n    const r = localStorage.getItem(\"latest_recommendation\");\n    const t = localStorage.getItem(\"tender_result\");\n    if (r) setRec(JSON.parse(r));\n    if (t) setTender(JSON.parse(t));\n  }, []);\n\n  useEffect(() => {\n    if (rec && rec.suggestions) {\n      // choose best that meets minProfit\n      const candidates = rec.suggestions.filter(s => (s.profit_margin_pct || 0) >= Number(minProfit));\n      const pool = candidates.length ? candidates : rec.suggestions;\n      const best = pool.reduce((a,b) => (a.expected_win_prob > b.expected_win_prob ? a : b), pool[0]);\n      setSelected(best);\n    }\n  }, [rec, minProfit]);\n\n  if (!rec) return <div style={{ padding: 12 }}>No recommendations available. From Tender Result click \"View Bid Recommendations\".</div>;\n\n  return (\n    <div style={{ padding: 12 }}>\n      <h2>Bid Recommendations</h2>\n\n      <div style={{ marginBottom: 12 }}>\n        <label>Minimum acceptable profit % (threshold): </label>\n        <input type=\"number\" value={minProfit} onChange={(e)=> setMinProfit(Number(e.target.value))} style={{ width: 80, marginLeft: 8 }} /> %\n        <div style={{ color: \"#666\", fontSize: 12, marginTop: 6 }}>System will choose highest win-prob among suggestions that meet this profit threshold. If none meet it, best overall suggestion is selected.</div>\n      </div>\n\n      <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n        <thead style={{ background: \"#f7f7f7\" }}>\n          <tr>\n            <th style={{ border: \"1px solid #ddd\", padding: 8 }}>Discount %</th>\n            <th style={{ border: \"1px solid #ddd\", padding: 8 }}>Per Litre</th>\n            <th style={{ border: \"1px solid #ddd\", padding: 8 }}>Total</th>\n            <th style={{ border: \"1px solid #ddd\", padding: 8 }}>Profit %</th>\n            <th style={{ border: \"1px solid #ddd\", padding: 8 }}>Win Prob</th>\n          </tr>\n        </thead>\n        <tbody>\n          {rec.suggestions.map((s, idx) => (\n            <tr key={idx} style={{ background: selected === s ? \"#e7f7e7\" : \"white\" }}>\n              <td style={{ border: \"1px solid #ddd\", padding: 8 }}>{s.discount_pct}%</td>\n              <td style={{ border: \"1px solid #ddd\", padding: 8 }}>{s.per_litre}</td>\n              <td style={{ border: \"1px solid #ddd\", padding: 8 }}>{s.total}</td>\n              <td style={{ border: \"1px solid #ddd\", padding: 8 }}>{s.profit_margin_pct}%</td>\n              <td style={{ border: \"1px solid #ddd\", padding: 8 }}>{s.expected_win_prob}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      <div style={{ marginTop: 12 }}>\n        <strong>Selected (based on threshold):</strong>\n        {selected ? (\n          <div style={{ marginTop: 8 }}>\n            <div>Discount: {selected.discount_pct}%</div>\n            <div>Per Litre: {selected.per_litre}</div>\n            <div>Total: {selected.total}</div>\n            <div>Expected win probability: {selected.expected_win_prob}</div>\n\n            <div style={{ marginTop: 10 }}>\n              <button onClick={() => {\n                // store chosen suggestion so company page knows\n                localStorage.setItem(\"chosen_suggestion\", JSON.stringify(selected));\n                window.location.href = \"/company\";\n              }}>Proceed to Company Details & Generate Final PDF</button>\n            </div>\n          </div>\n        ) : <div>No suggestion selected</div>}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}